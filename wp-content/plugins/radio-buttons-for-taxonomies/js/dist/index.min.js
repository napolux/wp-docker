/*! radio-buttons-for-taxonomies 2.0.3 */

!function(r){var n={};function o(e){if(n[e])return n[e].exports;var t=n[e]={i:e,l:!1,exports:{}};return r[e].call(t.exports,t,t.exports,o),t.l=!0,t.exports}o.m=r,o.c=n,o.d=function(e,t,r){o.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:r})},o.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},o.t=function(t,e){if(1&e&&(t=o(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var r=Object.create(null);if(o.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var n in t)o.d(r,n,function(e){return t[e]}.bind(null,n));return r},o.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return o.d(t,"a",t),t},o.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},o.p="",o(o.s="./js/src/index.js")}({"./js/src/index.js":function(e,t,r){"use strict";r.r(t);var n=r("./js/src/radio-term-selector.js");wp.hooks.addFilter("editor.PostTaxonomyType","RB4T",function(t){return function(e){return 0<=RB4Tl18n.radio_taxonomies.indexOf(e.slug)?wp.element.createElement(n.default,e):wp.element.createElement(t,e)}})},"./js/src/radio-term-selector.js":function(e,t,r){"use strict";r.r(t);var n=r("./node_modules/@babel/runtime/helpers/toConsumableArray.js"),p=r.n(n),o=r("./node_modules/@babel/runtime/helpers/defineProperty.js"),s=r.n(o),a=r("./node_modules/@babel/runtime/helpers/classCallCheck.js"),i=r.n(a),c=r("./node_modules/@babel/runtime/helpers/createClass.js"),l=r.n(c),u=r("./node_modules/@babel/runtime/helpers/possibleConstructorReturn.js"),d=r.n(u),m=r("./node_modules/@babel/runtime/helpers/getPrototypeOf.js"),f=r.n(m),b=r("./node_modules/@babel/runtime/helpers/assertThisInitialized.js"),h=r.n(b),y=r("./node_modules/@babel/runtime/helpers/inherits.js"),j=r.n(y),S=r("@wordpress/element"),C=r("lodash"),k=r("@wordpress/i18n"),F=r("@wordpress/components"),O=r("@wordpress/data"),g=r("@wordpress/compose"),_=r("@wordpress/api-fetch"),v=r.n(_),T=r("@wordpress/url"),w=r("./js/src/terms.js");function x(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})),r.push.apply(r,n)}return r}function P(t){for(var e=1;e<arguments.length;e++){var r=null!=arguments[e]?arguments[e]:{};e%2?x(Object(r),!0).forEach(function(e){s()(t,e,r[e])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):x(Object(r)).forEach(function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(r,e))})}return t}var A={per_page:-1,orderby:"name",order:"asc",_fields:"id,name,parent"},E=function(e){function t(){var e;return i()(this,t),(e=d()(this,f()(t).apply(this,arguments))).findTerm=e.findTerm.bind(h()(e)),e.onChange=e.onChange.bind(h()(e)),e.onChangeFormName=e.onChangeFormName.bind(h()(e)),e.onChangeFormParent=e.onChangeFormParent.bind(h()(e)),e.onAddTerm=e.onAddTerm.bind(h()(e)),e.onToggleForm=e.onToggleForm.bind(h()(e)),e.setFilterValue=e.setFilterValue.bind(h()(e)),e.sortBySelected=e.sortBySelected.bind(h()(e)),e.state={loading:!0,availableTermsTree:[],availableTerms:[],adding:!1,formName:"",formParent:"",showForm:!1,filterValue:"",filteredTermsTree:[]},e}return j()(t,e),l()(t,[{key:"onChange",value:function(e){var t=this.props,r=t.onUpdateTerms,n=t.taxonomy;r([parseInt(e.target.value,10)],n.rest_base)}},{key:"onChangeFormName",value:function(e){var t=""===e.target.value.trim()?"":e.target.value;this.setState({formName:t})}},{key:"onChangeFormParent",value:function(e){this.setState({formParent:e})}},{key:"onToggleForm",value:function(){this.setState(function(e){return{showForm:!e.showForm}})}},{key:"findTerm",value:function(e,t,r){return Object(C.find)(e,function(e){return(!e.parent&&!t||parseInt(e.parent)===parseInt(t))&&e.name.toLowerCase()===r.toLowerCase()})}},{key:"onAddTerm",value:function(e){var n=this;e.preventDefault();var t=this.props,o=t.onUpdateTerms,s=t.taxonomy,r=t.terms,a=t.slug,i=this.state,c=i.formName,l=i.formParent,u=i.adding,d=i.availableTerms;if(""!==c&&!u){var m=this.findTerm(d,l,c);if(m)return Object(C.some)(r,function(e){return e===m.id})||o([m.id],s.rest_base),void this.setState({formName:"",formParent:""});this.setState({adding:!0}),this.addRequest=v()({path:"/wp/v2/".concat(s.rest_base),method:"POST",data:{name:c,parent:l||void 0}}),this.addRequest.catch(function(e){return"term_exists"===e.code?(n.addRequest=v()({path:Object(T.addQueryArgs)("/wp/v2/".concat(s.rest_base),P({},A,{parent:l||0,search:c}))}),n.addRequest.then(function(e){return n.findTerm(e,l,c)})):Promise.reject(e)}).then(function(t){var e=!!Object(C.find)(n.state.availableTerms,function(e){return e.id===t.id})?n.state.availableTerms:[t].concat(p()(n.state.availableTerms)),r=Object(k.sprintf)(Object(k._x)("%s added","term"),Object(C.get)(n.props.taxonomy,["labels","singular_name"],"category"===a?Object(k.__)("Category"):Object(k.__)("Term")));n.props.speak(r,"assertive"),n.addRequest=null,n.setState({adding:!1,formName:"",formParent:"",availableTerms:e,availableTermsTree:n.sortBySelected(Object(w.buildTermsTree)(e))}),o([t.id],s.rest_base)},function(e){"abort"!==e.statusText&&(n.addRequest=null,n.setState({adding:!1}))})}}},{key:"componentDidMount",value:function(){this.fetchTerms()}},{key:"componentWillUnmount",value:function(){Object(C.invoke)(this.fetchRequest,["abort"]),Object(C.invoke)(this.addRequest,["abort"])}},{key:"componentDidUpdate",value:function(e){this.props.taxonomy!==e.taxonomy&&this.fetchTerms()}},{key:"fetchTerms",value:function(){var r=this,e=this.props.taxonomy;e&&(this.fetchRequest=v()({path:Object(T.addQueryArgs)("/wp/v2/".concat(e.rest_base),A)}),this.fetchRequest.then(function(e){var t=r.sortBySelected(Object(w.buildTermsTree)(e));r.fetchRequest=null,r.setState({loading:!1,availableTermsTree:t,availableTerms:e})},function(e){"abort"!==e.statusText&&(r.fetchRequest=null,r.setState({loading:!1}))}))}},{key:"sortBySelected",value:function(e){var r=this.props.terms,o=function e(t){return-1!==r.indexOf(t.id)||void 0!==t.children&&0<t.children.map(e).filter(function(e){return e}).length};return e.sort(function(e,t){var r=o(e),n=o(t);return r===n?0:r&&!n?-1:!r&&n?1:0}),e}},{key:"setFilterValue",value:function(e){var t=this.state.availableTermsTree,r=e.target.value,n=t.map(this.getFilterMatcher(r)).filter(function(e){return e});this.setState({filterValue:r,filteredTermsTree:n});var o=function e(t){for(var r=0,n=0;n<t.length;n++)r++,void 0!==t[n].children&&(r+=e(t[n].children));return r}(n),s=Object(k.sprintf)(Object(k._n)("%d result found.","%d results found.",o),o);this.props.debouncedSpeak(s,"assertive")}},{key:"getFilterMatcher",value:function(n){return function e(t){if(""===n)return t;var r=P({},t);return 0<r.children.length&&(r.children=r.children.map(e).filter(function(e){return e})),(-1!==r.name.toLowerCase().indexOf(n.toLowerCase())||0<r.children.length)&&r}}},{key:"renderTerms",value:function(e){var r=this,t=this.props,n=t.terms,o=void 0===n?[]:n,s=t.taxonomy.hierarchical?"hierarchical":"non-hierarchical";return e.map(function(e){var t="editor-post-taxonomies-".concat(s,"-term-").concat(e.id);return Object(S.createElement)("div",{key:e.id,className:"editor-post-taxonomies__"+s+"-terms-choice "},Object(S.createElement)("input",{id:t,className:"editor-post-taxonomies__"+s+"-terms-input ",type:"radio",checked:-1!==o.indexOf(e.id),value:e.id,onChange:r.onChange,name:"radio_tax_input-"+r.props.slug}),Object(S.createElement)("label",{htmlFor:t},Object(C.unescape)(e.name)),!!e.children.length&&Object(S.createElement)("div",{className:"editor-post-taxonomies__"+s+"-terms-subchoices "},r.renderTerms(e.children)))})}},{key:"render",value:function(){var e=this.props,n=e.slug,o=e.taxonomy,t=e.instanceId,r=e.hasCreateAction,s=e.hasAssignAction,a=o.hierarchical?"hierarchical":"non-hierarchical";if(!s)return null;var i=this.state,c=i.availableTermsTree,l=i.availableTerms,u=i.filteredTermsTree,d=i.formName,m=i.formParent,p=i.loading,f=i.showForm,b=i.filterValue,h=function(e,t,r){return Object(C.get)(o,["labels",e],"category"===n?t:r)},y=h("add_new_item",Object(k.__)("Add new category"),Object(k.__)("Add new term")),j=h("new_item_name",Object(k.__)("Add new category"),Object(k.__)("Add new term")),O=h("parent_item",Object(k.__)("Parent Category"),Object(k.__)("Parent Term")),g="— ".concat(O," —"),_=y,v="editor-post-taxonomies__".concat(a,"-terms-input-").concat(t),T="editor-post-taxonomies__".concat(a,"-terms-filter-").concat(t),w=Object(C.get)(this.props.taxonomy,["labels","search_items"],Object(k.__)("Search Terms")),x=Object(C.get)(this.props.taxonomy,["name"],Object(k.__)("Terms")),P=8<=l.length;return[P&&Object(S.createElement)("label",{key:"filter-label",htmlFor:T},w),P&&Object(S.createElement)("input",{type:"search",id:T,value:b,onChange:this.setFilterValue,className:"editor-post-taxonomies__hierarchical-terms-filter",key:"term-filter-input"}),Object(S.createElement)("div",{className:"editor-post-taxonomies__hierarchical-terms-list",key:"term-list",tabIndex:"0",role:"group","aria-label":x},this.renderTerms(""!==b?u:c)),!p&&r&&Object(S.createElement)(F.Button,{key:"term-add-button",onClick:this.onToggleForm,className:"editor-post-taxonomies__hierarchical-terms-add","aria-expanded":f,isLink:!0},y),f&&Object(S.createElement)("form",{onSubmit:this.onAddTerm,key:a+"-terms-form"},Object(S.createElement)("label",{htmlFor:v,className:"editor-post-taxonomies__hierarchical-terms-label"},j),Object(S.createElement)("input",{type:"text",id:v,className:"editor-post-taxonomies__hierarchical-terms-input",value:d,onChange:this.onChangeFormName,required:!0}),o.hierarchical&&!!l.length&&Object(S.createElement)(F.TreeSelect,{label:O,noOptionLabel:g,onChange:this.onChangeFormParent,selectedId:m,tree:c}),Object(S.createElement)(F.Button,{isSecondary:!0,type:"submit",className:"editor-post-taxonomies__hierarchical-terms-submit"},_))]}}]),t}(S.Component);t.default=Object(g.compose)([Object(O.withSelect)(function(e,t){var r=t.slug,n=e("core/editor").getCurrentPost,o=(0,e("core").getTaxonomy)(r);return{hasCreateAction:!!o&&Object(C.get)(n(),["_links","wp:action-create-"+o.rest_base],!1),hasAssignAction:!!o&&Object(C.get)(n(),["_links","wp:action-assign-"+o.rest_base],!1),terms:o?e("core/editor").getEditedPostAttribute(o.rest_base):[],taxonomy:o}}),Object(O.withDispatch)(function(r){return{onUpdateTerms:function(e,t){r("core/editor").editPost(s()({},t,e))}}}),F.withSpokenMessages,g.withInstanceId])(E)},"./js/src/terms.js":function(e,t,r){"use strict";r.r(t),r.d(t,"buildTermsTree",function(){return c});var n=r("./node_modules/@babel/runtime/helpers/defineProperty.js"),o=r.n(n),s=r("lodash");function a(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})),r.push.apply(r,n)}return r}function i(t){for(var e=1;e<arguments.length;e++){var r=null!=arguments[e]?arguments[e]:{};e%2?a(Object(r),!0).forEach(function(e){o()(t,e,r[e])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):a(Object(r)).forEach(function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(r,e))})}return t}function c(e){var t=e.map(function(e){return i({children:[],parent:null},e)}),n=Object(s.groupBy)(t,"parent");if(n.null&&n.null.length)return t;return function r(e){return e.map(function(e){var t=n[e.id];return i({},e,{children:t&&t.length?r(t):[]})})}(n[0]||[])}},"./node_modules/@babel/runtime/helpers/arrayWithoutHoles.js":function(e,t){e.exports=function(e){if(Array.isArray(e)){for(var t=0,r=new Array(e.length);t<e.length;t++)r[t]=e[t];return r}}},"./node_modules/@babel/runtime/helpers/assertThisInitialized.js":function(e,t){e.exports=function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}},"./node_modules/@babel/runtime/helpers/classCallCheck.js":function(e,t){e.exports=function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}},"./node_modules/@babel/runtime/helpers/createClass.js":function(e,t){function n(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}e.exports=function(e,t,r){return t&&n(e.prototype,t),r&&n(e,r),e}},"./node_modules/@babel/runtime/helpers/defineProperty.js":function(e,t){e.exports=function(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}},"./node_modules/@babel/runtime/helpers/getPrototypeOf.js":function(t,e){function r(e){return t.exports=r=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},r(e)}t.exports=r},"./node_modules/@babel/runtime/helpers/inherits.js":function(e,t,r){var n=r("./node_modules/@babel/runtime/helpers/setPrototypeOf.js");e.exports=function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&n(e,t)}},"./node_modules/@babel/runtime/helpers/iterableToArray.js":function(e,t){e.exports=function(e){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e))return Array.from(e)}},"./node_modules/@babel/runtime/helpers/nonIterableSpread.js":function(e,t){e.exports=function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}},"./node_modules/@babel/runtime/helpers/possibleConstructorReturn.js":function(e,t,r){var n=r("./node_modules/@babel/runtime/helpers/typeof.js"),o=r("./node_modules/@babel/runtime/helpers/assertThisInitialized.js");e.exports=function(e,t){return!t||"object"!==n(t)&&"function"!=typeof t?o(e):t}},"./node_modules/@babel/runtime/helpers/setPrototypeOf.js":function(r,e){function n(e,t){return r.exports=n=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},n(e,t)}r.exports=n},"./node_modules/@babel/runtime/helpers/toConsumableArray.js":function(e,t,r){var n=r("./node_modules/@babel/runtime/helpers/arrayWithoutHoles.js"),o=r("./node_modules/@babel/runtime/helpers/iterableToArray.js"),s=r("./node_modules/@babel/runtime/helpers/nonIterableSpread.js");e.exports=function(e){return n(e)||o(e)||s()}},"./node_modules/@babel/runtime/helpers/typeof.js":function(t,e){function r(e){return"function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?t.exports=r=function(e){return typeof e}:t.exports=r=function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},r(e)}t.exports=r},"@wordpress/api-fetch":function(e,t){!function(){e.exports=this.wp.apiFetch}()},"@wordpress/components":function(e,t){!function(){e.exports=this.wp.components}()},"@wordpress/compose":function(e,t){!function(){e.exports=this.wp.compose}()},"@wordpress/data":function(e,t){!function(){e.exports=this.wp.data}()},"@wordpress/element":function(e,t){!function(){e.exports=this.wp.element}()},"@wordpress/i18n":function(e,t){!function(){e.exports=this.wp.i18n}()},"@wordpress/url":function(e,t){!function(){e.exports=this.wp.url}()},lodash:function(e,t){!function(){e.exports=this.lodash}()}});